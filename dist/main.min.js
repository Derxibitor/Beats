$(
() => {
    let color  = document.getElementsByClassName("colors__item")
    let colorArray = Array.from(color)

    colorArray.forEach((element) => {
        element.addEventListener("click", function(e) {
            targetText = $(e.target).next(".color__info")
            targetTextStatus = $(targetText).css("width")
            targetBlock = $(e.target).find(".color__menu-block")
            targetBox = $(e.target).closest(".colors__item")
            colorItem = document.querySelectorAll(".colors__item")

            if (targetTextStatus == "0px") {
                $(".colors__title").addClass("color__title--hover")
                $(".color__info").removeClass("color__info--hover")
                $(targetText).addClass("color__info--hover")
                $(colorItem).addClass("color__item--hover")
                $(targetBox).removeClass("color__item--hover")
            } else {
                $(".colors__item").removeClass("color__item--hover")
                $(".color__info").removeClass("color__info--hover")
                $(".colors__title").removeClass("color__title--hover")
            }
        })
    })
});$(
    () => {
    const validateFields = (form, fieldsArray) => {
        fieldsArray.forEach((field) => {
            field.removeClass("input-error")
            if (field.val().trim() == "") {
                field.addClass("input-error")
            }
        })

        const errorFields = form.find(".input-error")

        return errorFields.length == 0;
    }

    $(".form").submit(e => {
        e.preventDefault();

        const form = $(e.target)
        const name = form.find("[name='name']")
        const phone = form.find("[name='phone']")
        const comment = form.find("[name='comment']")
        const to = form.find("[name='to']")

        const isValid = validateFields(form, [name, phone, comment, to])

        const modal = $("#modal")
        const content = modal.find(".modal__content")

        modal.removeClass("error-modal")

        if (isValid) {
            const request = $.ajax({
                url: "https://webdev-api.loftschool.com/sendmail",
                method: "post",
                data: {
                    name: name.val(),
                    phone: phone.val(),
                    comment: comment.val(),
                    to: to.val()
                }
            })

            request.done((data) => {
                content.text(data.message)
            })

            request.fail((data) => {
                if (data.responseJSON) {
                    content.text(data.responseJSON.massage)
                }   else {
                    content.text('Произошла ошибка, попробуйте снова')
                }
                modal.addClass("error-modal")
            })

            request.always(() => {
                $.fancybox.open({
                    src: "#modal",
                    type: "inline"
                })
            })
        }
    })

    $(".app-submit-btn").click(e => {
        e.preventDefault();

        $.fancybox.close();
    })
});$(
    () => {
    $(".cross").on("click", () => {
        $(".fullscreen__menu").css("display", "none")
    })

    $(".dropdown").on("click", () => {
        $(".fullscreen__menu").css("display", "flex")
    })
});;let myMap;

const init = () => {
    myMap = new ymaps.Map("footer__map", {
        center: [55.76, 37.64],
        zoom: 13
    })

    const coords = [
        [55.759065, 37.616090],
        [55.750631, 37.611138],
        [55.745425, 37.589202],
        [55.757906, 37.588882]
    ]

    const myCollection = new ymaps.GeoObjectCollection({}, {
        draggable: false,
        iconLayout: 'default#image',
        iconImageHref: "./img/marker.png",
        iconImageSize: [46,57],
        iconImageOffset: [-35,-52],
    })

    coords.forEach(coord => {
        myCollection.add(new ymaps.Placemark(coord))
    })

    myMap.geoObjects.add(myCollection)

    myMap.behaviors.disable('scrollZoom')
};

ymaps.ready(init);;const sections = $("section")
const display = $(".main")

const performTransition = sectionEq => {
    const position = sectionEq * -100;

    display.css({
        transform: `translateY(${position}%)`
    });
}

$(window).on("wheel", e => {
    const deltaY = e.originalEvent.deltaY;

    if (deltaY > 0) {
        performTransition(8);
    } else if (deltaY < 0) {
        console.log(deltaY);
    }
});let player;
const playerContainer = $('.player')

let eventsInit = () => {
    $(".player__start").click(e => {
        e.preventDefault();

        if (playerContainer.hasClass("paused")) {
            playerContainer.removeClass("paused")
            player.pauseVideo()
        } else {
            playerContainer.addClass("paused")
            player.playVideo()
        }
    })
}

const formatTime = timeSec => {
    const roundTime = Math.round(timeSec);

    const minutes = addZero(Math.floor(roundTime / 60));
    const seconds = addZero(roundTime - minutes * 60);

    function addZero(num) {
        return num < 10 ? '0${num}' : num;
    }

    return '${minutes} : ${seconds}'
}

const onPlayerReady = () => {
    let interval;
    const durationSec = player.getDuration();
    
    $(".player__duration-estimate").text(formatTime(durationSec))

    if (typeof interval != 'undefined') {
        clearInterval(interval);
    }

    interval = setInterval(() => {
        const completedSec = player.getCurrentTime();
        const completedPercent = (completedSec / durationSec) * 100;
      
        $(".player__playback-button").css({
          left: `${completedPercent}%`
        });
       
        $(".player__duration-completed").text(formatTime(completedSec));
    }, 1000);
}

function onYouTubeIframeAPIReady() {
    player = new YT.Player('yt-player', {
        height: '390',
        width: '660',
        videoId: 'jpmJC4qBILs',
        events: {
            // 'onReady': onPlayerReady,
            // 'onStageChange': onPlayerStateChange,
        },
        playerVars: {
            controls: 0,
            disablekb: 0,
            showinfo: 0,
            rel: 0,
            autoplay: 0,
            modestbranding: 0
        }
    })
};$(
    () => {
    let userLink = document.getElementsByClassName("user-list__link")
    let userArray = Array.from(userLink)

    const findBlockByAlias = alias => {
        return $(".review__item").filter((ndx, item) => {
            return $(item).attr("data-linked-with") == alias;
        })
    }

    userArray.forEach((element) => {
        element.addEventListener("click", function (e) {
            let currentLink = $(e.target).closest(userLink)
            const target = $(e.target).attr("data-open")
            const itemToShow = findBlockByAlias(target)

            e.preventDefault();
            $(currentLink).addClass("user-list__link--active").siblings().removeClass("user-list__link--active")
            itemToShow.addClass("review__item--active").siblings().removeClass("review__item--active")
        });
    })
});;$(
    () => {
    const slider =  $('.products__list').bxSlider({
        pager: false,
        controls: false
    });

    $('.product__arrow--prev').click(e => {
        e.preventDefault();

        slider.goToPrevSlide();
    })
    $('.product__arrow--next').click(e => {
        e.preventDefault();

        slider.goToNextSlide();
    })
});;$(
    () => {
    let memberParam = document.getElementsByClassName("name__row")
    let memberArray = Array.from(memberParam)

    memberArray.forEach((element) => {
        element.addEventListener("click", function(e) {
            e.preventDefault();

            let target = $(e.target).closest('.name__row')
            let targetBox = $(target).siblings('.member__param-box')
            let targetStatus = $(targetBox).css("display")
            let arrow = $(e.target).siblings(".arrow-down")

            arrow.toggleClass("arrow--up")
            
            if (targetStatus == "none") {
                $('.member__param-box').css("display", "none")
                $(targetBox).css("display", "grid");
            } else if (targetStatus == "grid") {
                $(targetBox).css("display", "none");
            }

        })
    })
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbG9ycy5qcyIsImZvcm0uanMiLCJoYW1idXJnZXIuanMiLCJtYXAuanMiLCJvblBhZ2VTY3JvbGwuanMiLCJwbGF5ZXIuanMiLCJyZXZpZXdzLmpzIiwic2xpZGVyLmpzIiwidGVhbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0MxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQ3RFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKFxyXG4oKSA9PiB7XHJcbiAgICBsZXQgY29sb3IgID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbG9yc19faXRlbVwiKVxyXG4gICAgbGV0IGNvbG9yQXJyYXkgPSBBcnJheS5mcm9tKGNvbG9yKVxyXG5cclxuICAgIGNvbG9yQXJyYXkuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdGFyZ2V0VGV4dCA9ICQoZS50YXJnZXQpLm5leHQoXCIuY29sb3JfX2luZm9cIilcclxuICAgICAgICAgICAgdGFyZ2V0VGV4dFN0YXR1cyA9ICQodGFyZ2V0VGV4dCkuY3NzKFwid2lkdGhcIilcclxuICAgICAgICAgICAgdGFyZ2V0QmxvY2sgPSAkKGUudGFyZ2V0KS5maW5kKFwiLmNvbG9yX19tZW51LWJsb2NrXCIpXHJcbiAgICAgICAgICAgIHRhcmdldEJveCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoXCIuY29sb3JzX19pdGVtXCIpXHJcbiAgICAgICAgICAgIGNvbG9ySXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29sb3JzX19pdGVtXCIpXHJcblxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0VGV4dFN0YXR1cyA9PSBcIjBweFwiKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiLmNvbG9yc19fdGl0bGVcIikuYWRkQ2xhc3MoXCJjb2xvcl9fdGl0bGUtLWhvdmVyXCIpXHJcbiAgICAgICAgICAgICAgICAkKFwiLmNvbG9yX19pbmZvXCIpLnJlbW92ZUNsYXNzKFwiY29sb3JfX2luZm8tLWhvdmVyXCIpXHJcbiAgICAgICAgICAgICAgICAkKHRhcmdldFRleHQpLmFkZENsYXNzKFwiY29sb3JfX2luZm8tLWhvdmVyXCIpXHJcbiAgICAgICAgICAgICAgICAkKGNvbG9ySXRlbSkuYWRkQ2xhc3MoXCJjb2xvcl9faXRlbS0taG92ZXJcIilcclxuICAgICAgICAgICAgICAgICQodGFyZ2V0Qm94KS5yZW1vdmVDbGFzcyhcImNvbG9yX19pdGVtLS1ob3ZlclwiKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJChcIi5jb2xvcnNfX2l0ZW1cIikucmVtb3ZlQ2xhc3MoXCJjb2xvcl9faXRlbS0taG92ZXJcIilcclxuICAgICAgICAgICAgICAgICQoXCIuY29sb3JfX2luZm9cIikucmVtb3ZlQ2xhc3MoXCJjb2xvcl9faW5mby0taG92ZXJcIilcclxuICAgICAgICAgICAgICAgICQoXCIuY29sb3JzX190aXRsZVwiKS5yZW1vdmVDbGFzcyhcImNvbG9yX190aXRsZS0taG92ZXJcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59KSIsIiQoXHJcbiAgICAoKSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0ZUZpZWxkcyA9IChmb3JtLCBmaWVsZHNBcnJheSkgPT4ge1xyXG4gICAgICAgIGZpZWxkc0FycmF5LmZvckVhY2goKGZpZWxkKSA9PiB7XHJcbiAgICAgICAgICAgIGZpZWxkLnJlbW92ZUNsYXNzKFwiaW5wdXQtZXJyb3JcIilcclxuICAgICAgICAgICAgaWYgKGZpZWxkLnZhbCgpLnRyaW0oKSA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZC5hZGRDbGFzcyhcImlucHV0LWVycm9yXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBjb25zdCBlcnJvckZpZWxkcyA9IGZvcm0uZmluZChcIi5pbnB1dC1lcnJvclwiKVxyXG5cclxuICAgICAgICByZXR1cm4gZXJyb3JGaWVsZHMubGVuZ3RoID09IDA7XHJcbiAgICB9XHJcblxyXG4gICAgJChcIi5mb3JtXCIpLnN1Ym1pdChlID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGZvcm0gPSAkKGUudGFyZ2V0KVxyXG4gICAgICAgIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoXCJbbmFtZT0nbmFtZSddXCIpXHJcbiAgICAgICAgY29uc3QgcGhvbmUgPSBmb3JtLmZpbmQoXCJbbmFtZT0ncGhvbmUnXVwiKVxyXG4gICAgICAgIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpXHJcbiAgICAgICAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKVxyXG5cclxuICAgICAgICBjb25zdCBpc1ZhbGlkID0gdmFsaWRhdGVGaWVsZHMoZm9ybSwgW25hbWUsIHBob25lLCBjb21tZW50LCB0b10pXHJcblxyXG4gICAgICAgIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKVxyXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBtb2RhbC5maW5kKFwiLm1vZGFsX19jb250ZW50XCIpXHJcblxyXG4gICAgICAgIG1vZGFsLnJlbW92ZUNsYXNzKFwiZXJyb3ItbW9kYWxcIilcclxuXHJcbiAgICAgICAgaWYgKGlzVmFsaWQpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9ICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnQ6IGNvbW1lbnQudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgdG86IHRvLnZhbCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICByZXF1ZXN0LmRvbmUoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQudGV4dChkYXRhLm1lc3NhZ2UpXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3BvbnNlSlNPTikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQudGV4dChkYXRhLnJlc3BvbnNlSlNPTi5tYXNzYWdlKVxyXG4gICAgICAgICAgICAgICAgfSAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQudGV4dCgn0J/RgNC+0LjQt9C+0YjQu9CwINC+0YjQuNCx0LrQsCwg0L/QvtC/0YDQvtCx0YPQudGC0LUg0YHQvdC+0LLQsCcpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtb2RhbC5hZGRDbGFzcyhcImVycm9yLW1vZGFsXCIpXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICByZXF1ZXN0LmFsd2F5cygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgICAgIHNyYzogXCIjbW9kYWxcIixcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImlubGluZVwiXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgJChcIi5hcHAtc3VibWl0LWJ0blwiKS5jbGljayhlID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICQuZmFuY3lib3guY2xvc2UoKTtcclxuICAgIH0pXHJcbn0pIiwiJChcclxuICAgICgpID0+IHtcclxuICAgICQoXCIuY3Jvc3NcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgJChcIi5mdWxsc2NyZWVuX19tZW51XCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpXHJcbiAgICB9KVxyXG5cclxuICAgICQoXCIuZHJvcGRvd25cIikub24oXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgJChcIi5mdWxsc2NyZWVuX19tZW51XCIpLmNzcyhcImRpc3BsYXlcIiwgXCJmbGV4XCIpXHJcbiAgICB9KVxyXG59KTsiLCJsZXQgbXlNYXA7XHJcblxyXG5jb25zdCBpbml0ID0gKCkgPT4ge1xyXG4gICAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwiZm9vdGVyX19tYXBcIiwge1xyXG4gICAgICAgIGNlbnRlcjogWzU1Ljc2LCAzNy42NF0sXHJcbiAgICAgICAgem9vbTogMTNcclxuICAgIH0pXHJcblxyXG4gICAgY29uc3QgY29vcmRzID0gW1xyXG4gICAgICAgIFs1NS43NTkwNjUsIDM3LjYxNjA5MF0sXHJcbiAgICAgICAgWzU1Ljc1MDYzMSwgMzcuNjExMTM4XSxcclxuICAgICAgICBbNTUuNzQ1NDI1LCAzNy41ODkyMDJdLFxyXG4gICAgICAgIFs1NS43NTc5MDYsIDM3LjU4ODg4Ml1cclxuICAgIF1cclxuXHJcbiAgICBjb25zdCBteUNvbGxlY3Rpb24gPSBuZXcgeW1hcHMuR2VvT2JqZWN0Q29sbGVjdGlvbih7fSwge1xyXG4gICAgICAgIGRyYWdnYWJsZTogZmFsc2UsXHJcbiAgICAgICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxyXG4gICAgICAgIGljb25JbWFnZUhyZWY6IFwiLi9pbWcvbWFya2VyLnBuZ1wiLFxyXG4gICAgICAgIGljb25JbWFnZVNpemU6IFs0Niw1N10sXHJcbiAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTM1LC01Ml0sXHJcbiAgICB9KVxyXG5cclxuICAgIGNvb3Jkcy5mb3JFYWNoKGNvb3JkID0+IHtcclxuICAgICAgICBteUNvbGxlY3Rpb24uYWRkKG5ldyB5bWFwcy5QbGFjZW1hcmsoY29vcmQpKVxyXG4gICAgfSlcclxuXHJcbiAgICBteU1hcC5nZW9PYmplY3RzLmFkZChteUNvbGxlY3Rpb24pXHJcblxyXG4gICAgbXlNYXAuYmVoYXZpb3JzLmRpc2FibGUoJ3Njcm9sbFpvb20nKVxyXG59O1xyXG5cclxueW1hcHMucmVhZHkoaW5pdCk7IiwiY29uc3Qgc2VjdGlvbnMgPSAkKFwic2VjdGlvblwiKVxyXG5jb25zdCBkaXNwbGF5ID0gJChcIi5tYWluXCIpXHJcblxyXG5jb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IHNlY3Rpb25FcSAqIC0xMDA7XHJcblxyXG4gICAgZGlzcGxheS5jc3Moe1xyXG4gICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoJHtwb3NpdGlvbn0lKWBcclxuICAgIH0pO1xyXG59XHJcblxyXG4kKHdpbmRvdykub24oXCJ3aGVlbFwiLCBlID0+IHtcclxuICAgIGNvbnN0IGRlbHRhWSA9IGUub3JpZ2luYWxFdmVudC5kZWx0YVk7XHJcblxyXG4gICAgaWYgKGRlbHRhWSA+IDApIHtcclxuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbig4KTtcclxuICAgIH0gZWxzZSBpZiAoZGVsdGFZIDwgMCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRlbHRhWSk7XHJcbiAgICB9XHJcbn0pIiwibGV0IHBsYXllcjtcclxuY29uc3QgcGxheWVyQ29udGFpbmVyID0gJCgnLnBsYXllcicpXHJcblxyXG5sZXQgZXZlbnRzSW5pdCA9ICgpID0+IHtcclxuICAgICQoXCIucGxheWVyX19zdGFydFwiKS5jbGljayhlID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIGlmIChwbGF5ZXJDb250YWluZXIuaGFzQ2xhc3MoXCJwYXVzZWRcIikpIHtcclxuICAgICAgICAgICAgcGxheWVyQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwicGF1c2VkXCIpXHJcbiAgICAgICAgICAgIHBsYXllci5wYXVzZVZpZGVvKClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb250YWluZXIuYWRkQ2xhc3MoXCJwYXVzZWRcIilcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlWaWRlbygpXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufVxyXG5cclxuY29uc3QgZm9ybWF0VGltZSA9IHRpbWVTZWMgPT4ge1xyXG4gICAgY29uc3Qgcm91bmRUaW1lID0gTWF0aC5yb3VuZCh0aW1lU2VjKTtcclxuXHJcbiAgICBjb25zdCBtaW51dGVzID0gYWRkWmVybyhNYXRoLmZsb29yKHJvdW5kVGltZSAvIDYwKSk7XHJcbiAgICBjb25zdCBzZWNvbmRzID0gYWRkWmVybyhyb3VuZFRpbWUgLSBtaW51dGVzICogNjApO1xyXG5cclxuICAgIGZ1bmN0aW9uIGFkZFplcm8obnVtKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bSA8IDEwID8gJzAke251bX0nIDogbnVtO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAnJHttaW51dGVzfSA6ICR7c2Vjb25kc30nXHJcbn1cclxuXHJcbmNvbnN0IG9uUGxheWVyUmVhZHkgPSAoKSA9PiB7XHJcbiAgICBsZXQgaW50ZXJ2YWw7XHJcbiAgICBjb25zdCBkdXJhdGlvblNlYyA9IHBsYXllci5nZXREdXJhdGlvbigpO1xyXG4gICAgXHJcbiAgICAkKFwiLnBsYXllcl9fZHVyYXRpb24tZXN0aW1hdGVcIikudGV4dChmb3JtYXRUaW1lKGR1cmF0aW9uU2VjKSlcclxuXHJcbiAgICBpZiAodHlwZW9mIGludGVydmFsICE9ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XHJcbiAgICB9XHJcblxyXG4gICAgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY29tcGxldGVkU2VjID0gcGxheWVyLmdldEN1cnJlbnRUaW1lKCk7XHJcbiAgICAgICAgY29uc3QgY29tcGxldGVkUGVyY2VudCA9IChjb21wbGV0ZWRTZWMgLyBkdXJhdGlvblNlYykgKiAxMDA7XHJcbiAgICAgIFxyXG4gICAgICAgICQoXCIucGxheWVyX19wbGF5YmFjay1idXR0b25cIikuY3NzKHtcclxuICAgICAgICAgIGxlZnQ6IGAke2NvbXBsZXRlZFBlcmNlbnR9JWBcclxuICAgICAgICB9KTtcclxuICAgICAgIFxyXG4gICAgICAgICQoXCIucGxheWVyX19kdXJhdGlvbi1jb21wbGV0ZWRcIikudGV4dChmb3JtYXRUaW1lKGNvbXBsZXRlZFNlYykpO1xyXG4gICAgfSwgMTAwMCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9uWW91VHViZUlmcmFtZUFQSVJlYWR5KCkge1xyXG4gICAgcGxheWVyID0gbmV3IFlULlBsYXllcigneXQtcGxheWVyJywge1xyXG4gICAgICAgIGhlaWdodDogJzM5MCcsXHJcbiAgICAgICAgd2lkdGg6ICc2NjAnLFxyXG4gICAgICAgIHZpZGVvSWQ6ICdqcG1KQzRxQklMcycsXHJcbiAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgIC8vICdvblJlYWR5Jzogb25QbGF5ZXJSZWFkeSxcclxuICAgICAgICAgICAgLy8gJ29uU3RhZ2VDaGFuZ2UnOiBvblBsYXllclN0YXRlQ2hhbmdlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGxheWVyVmFyczoge1xyXG4gICAgICAgICAgICBjb250cm9sczogMCxcclxuICAgICAgICAgICAgZGlzYWJsZWtiOiAwLFxyXG4gICAgICAgICAgICBzaG93aW5mbzogMCxcclxuICAgICAgICAgICAgcmVsOiAwLFxyXG4gICAgICAgICAgICBhdXRvcGxheTogMCxcclxuICAgICAgICAgICAgbW9kZXN0YnJhbmRpbmc6IDBcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59IiwiJChcclxuICAgICgpID0+IHtcclxuICAgIGxldCB1c2VyTGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ1c2VyLWxpc3RfX2xpbmtcIilcclxuICAgIGxldCB1c2VyQXJyYXkgPSBBcnJheS5mcm9tKHVzZXJMaW5rKVxyXG5cclxuICAgIGNvbnN0IGZpbmRCbG9ja0J5QWxpYXMgPSBhbGlhcyA9PiB7XHJcbiAgICAgICAgcmV0dXJuICQoXCIucmV2aWV3X19pdGVtXCIpLmZpbHRlcigobmR4LCBpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtlZC13aXRoXCIpID09IGFsaWFzO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgdXNlckFycmF5LmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudExpbmsgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KHVzZXJMaW5rKVxyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSAkKGUudGFyZ2V0KS5hdHRyKFwiZGF0YS1vcGVuXCIpXHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1Ub1Nob3cgPSBmaW5kQmxvY2tCeUFsaWFzKHRhcmdldClcclxuXHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgJChjdXJyZW50TGluaykuYWRkQ2xhc3MoXCJ1c2VyLWxpc3RfX2xpbmstLWFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwidXNlci1saXN0X19saW5rLS1hY3RpdmVcIilcclxuICAgICAgICAgICAgaXRlbVRvU2hvdy5hZGRDbGFzcyhcInJldmlld19faXRlbS0tYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJyZXZpZXdfX2l0ZW0tLWFjdGl2ZVwiKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSlcclxufSk7IiwiJChcclxuICAgICgpID0+IHtcclxuICAgIGNvbnN0IHNsaWRlciA9ICAkKCcucHJvZHVjdHNfX2xpc3QnKS5ieFNsaWRlcih7XHJcbiAgICAgICAgcGFnZXI6IGZhbHNlLFxyXG4gICAgICAgIGNvbnRyb2xzOiBmYWxzZVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnLnByb2R1Y3RfX2Fycm93LS1wcmV2JykuY2xpY2soZSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICBzbGlkZXIuZ29Ub1ByZXZTbGlkZSgpO1xyXG4gICAgfSlcclxuICAgICQoJy5wcm9kdWN0X19hcnJvdy0tbmV4dCcpLmNsaWNrKGUgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgc2xpZGVyLmdvVG9OZXh0U2xpZGUoKTtcclxuICAgIH0pXHJcbn0pOyIsIiQoXHJcbiAgICAoKSA9PiB7XHJcbiAgICBsZXQgbWVtYmVyUGFyYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibmFtZV9fcm93XCIpXHJcbiAgICBsZXQgbWVtYmVyQXJyYXkgPSBBcnJheS5mcm9tKG1lbWJlclBhcmFtKVxyXG5cclxuICAgIG1lbWJlckFycmF5LmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgIGxldCB0YXJnZXQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCcubmFtZV9fcm93JylcclxuICAgICAgICAgICAgbGV0IHRhcmdldEJveCA9ICQodGFyZ2V0KS5zaWJsaW5ncygnLm1lbWJlcl9fcGFyYW0tYm94JylcclxuICAgICAgICAgICAgbGV0IHRhcmdldFN0YXR1cyA9ICQodGFyZ2V0Qm94KS5jc3MoXCJkaXNwbGF5XCIpXHJcbiAgICAgICAgICAgIGxldCBhcnJvdyA9ICQoZS50YXJnZXQpLnNpYmxpbmdzKFwiLmFycm93LWRvd25cIilcclxuXHJcbiAgICAgICAgICAgIGFycm93LnRvZ2dsZUNsYXNzKFwiYXJyb3ctLXVwXCIpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0U3RhdHVzID09IFwibm9uZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcubWVtYmVyX19wYXJhbS1ib3gnKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKVxyXG4gICAgICAgICAgICAgICAgJCh0YXJnZXRCb3gpLmNzcyhcImRpc3BsYXlcIiwgXCJncmlkXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldFN0YXR1cyA9PSBcImdyaWRcIikge1xyXG4gICAgICAgICAgICAgICAgJCh0YXJnZXRCb3gpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59KTsiXX0=
